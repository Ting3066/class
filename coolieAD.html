<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    body {
      margin: 0;

    }

    #myFull {
      width: 100vw;
      height: 100vh;
      background: rgba(30, 30, 30, 0.5);
      position: fixed;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      padding: 20px;
    }

    #myAd{
      position: relative;
      cursor: pointer;
    }

    #adClose{
      position: absolute;
      right: -1.5rem;
      top: -1.5rem;
      border-radius: 50%;
      line-height: 0;
      background: #eee;
    }

    #adClose:hover{
      background: #ccc;

    }
  </style>
</head>

<body>
  <div id="myFull">
    <div id="myAd">
      <img src="https://picsum.photos/350/450/?random=1" onclick="gotoAD()">
      <div id="adClose">
        <span class="material-icons">highlight_off</span>
      </div>
    </div>
  </div>

  <div class="container">
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
    <h1>HELLO WORLD</h1>
  </div>



  <script>
    //寫法一
    // function gotoAD(){
    //   window.open("https://www.google.com/","_blank"); //bom  window可省略
    // }

    //寫法二
    const gotoAD=()=>{
      open("https://www.google.com/","_blank");
      // console.log("img active");
    }


    //將廣告頁面display設為none
    const closetoAd=()=>{
      document.getElementById("myFull").style.display="none";
      // console.log("myFull");
    }
    //點擊X或灰色區域時，都可觸發function關閉廣告頁面
    document.getElementById("adClose").onclick=closetoAd;
    // document.getElementById("myFull").onclick=closetoAd; 
    document.getElementById("myFull").addEventListener("click",closetoAd);  //用event去監聽click事件


    // document.cookie="hello=world";
    /*
    select
    console.log(document.cookie);

    insert & update

    delete=update + deadline before
    */

    /*
    //刪除cookie  set deadtime
    const endTime=new Date();
    // console.log(endTime);
    // endTime.setTime(endTime.getTime()+10000);  //方法一
    endTime.setSeconds(endTime.getSeconds()+10);  //方法二
    // console.log(endTime);

    document.cookie="hello=world;expires="+endTime.toUTCString();
    */

    function findCookie(name){
      const ckary=document.cookie.split("; ");
      // console.log(ckary);
      const getck=ckary.find(function(e){  //find會找到第一個滿足條件的元素並回傳true後中斷執行，若都不符合回傳false
        const ans=(name+"="==e.substr(0,name.length+1));
        return ans; 
        /*
        boolean T will getck=e;
        boolean F do each next;
        */
      });
      // console.log(getck);
      if(getck!=undefined){
        return getck.split("=")[1];  //有找到時，回傳該字串的"="後面的內文

      }else{
        return false;
      }

    }

    //將型態轉換為物件，再用in方法搜尋
    const findCookie2=(name)=>{
      const ckary=document.cookie.split("; "); //ary, ckary[0]="hello=world"
      let objCK=new Object();  //產生一個新的空物件

      ckary.forEach((e)=>{  //e="hello=world" at firstTime
        const cacheAry=e.split("=");  //cache[0]=hello ,cache[1]=world
        objCK[cacheAry[0]]=cacheAry[1];
      });
      //可以縮寫成以下
      // ckary.forEach(e=>{objCK[e.split("=")[0]]=e.split("=")[1];});
      if(name in objCK){
        return objCK[name];
      }else{
        return false;
      }
    }

    if(!findCookie2("watchAD")){  //代表還沒被指定cookie,等於新訪客-->塞cookie且過期時間為今晚午夜
      const endTime=new Date();
      endTime.setHours(23),endTime.setMinutes(59),endTime.setSeconds(59);
      // console.log(endTime);
      document.cookie="watchAD=yes;expires="+endTime.toUTCString();
    }else{ //有找到cookie，代表已來訪過-->拿掉廣告
      // closetoAd();  方法一
      document.getElementById("myFull").remove(); //方法二，直接將div移除
    }
  </script>
</body>

</html>